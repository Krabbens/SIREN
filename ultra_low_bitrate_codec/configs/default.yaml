model:
  # Feature Extractor
  hubert_model: "facebook/hubert-base-ls960"
  hubert_layer: 9  # Best phonetic layer
  freeze_hubert: true
  
  # Quantizer Settings
  quantizer_type: "fsq" # "vq" or "fsq"
  fsq_levels: [8, 5, 5, 5] # 1000 codes
  
  # Semantic Branch
  semantic:
    input_dim: 768
    hidden_dim: 128
    output_dim: 4     # Changed to 4 for FSQ (len(fsq_levels))
    temporal_compression: 4  # 50fps → 12.5fps
    vocab_size: 1000  # 8*5*5*5
    
  # Prosody Branch  
  prosody:
    input_dim: 768
    hidden_dim: 64
    output_dim: 4     # Changed to 4 for FSQ
    temporal_compression: 8  # 50fps → 6.25fps
    vocab_size: 1000  # Using same FSQ config for simplicity?
    
  # Speaker
  speaker:
    embedding_dim: 256
    num_groups: 8
    codes_per_group: 256  # 8 bits per group
    
  # Entropy Coding
  entropy:
    enabled: true
    lm_layers: 2
    lm_dim: 128
    lm_heads: 4
    context_length: 64
    
    
  # Decoder (Fusion)
  decoder:
    fusion_dim: 256        # Was 128
    fusion_heads: 4        # Reduced for speed
    fusion_layers: 2       # Reduced for speed
    dropout: 0.18
        
  # Vocoder
  vocoder:
    type: "vocos"
    pretrained: false # It's trained from scratch in this script

training:
  batch_size: 16   # Increased for better GPU utilization
  learning_rate: 4e-4 # Increased to speed up convergence
  warmup_steps: 1000
  max_steps: 10000 # 10 epochs x 1000 steps assumption
  num_workers: 8   # User requested 8
  
  # VQ/FSQ specific
  commitment_weight: 0.25 # Implicit in FSQ but used for auxiliary
  codebook_ema_decay: 0.99
  
  # Loss weights
  reconstruction_weight: 1.0
  perceptual_weight: 0.1 # Need to ensure perceptual loss calc exists or remove
  speaker_weight: 0.5
  
  # Logging
  log_every: 100
  eval_every: 1000
  save_every: 200 # Save spectrogram every 200 steps
  
data:
  train_manifest: "/home/sperm/diff/data/train.json"
  val_manifest: "/home/sperm/diff/data/val.json"
  sample_rate: 16000
  max_duration: 10.0  # seconds
  min_duration: 1.0

audio:
  sample_rate: 16000
  hop_length: 320  # For HuBERT (16000/50 = 320)
