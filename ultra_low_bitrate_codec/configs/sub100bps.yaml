model:
  # Feature Extractor
  hubert_model: "facebook/hubert-base-ls960"
  hubert_layer: 9
  freeze_hubert: true
  
  # =========================================
  # QUANTIZER - INCREASED CAPACITY
  # =========================================
  quantizer_type: "rfsq"
  fsq_levels: [8, 8, 8, 8, 8, 8, 8, 8]  # 8 dims @ 8 levels
  rfsq_num_levels: 3  # More residual refinement
  
  # =========================================
  # SEMANTIC - FASTER TEMPORAL, MORE DIMS
  # =========================================
  semantic:
    input_dim: 768
    hidden_dim: 256
    output_dim: 8       # Was 4
    temporal_compression: 2  # Was 4 → 25Hz instead of 12.5Hz
    vocab_size: 512  # 8 levels per dim * 8 dims * 8 residual levels = reasonable
    
  # =========================================
  # PROSODY - FASTER TEMPORAL, MORE DIMS
  # =========================================
  prosody:
    input_dim: 768
    hidden_dim: 128
    output_dim: 8       # Was 4
    temporal_compression: 8  # Was 16 → 6.25Hz instead of 3.125Hz
    vocab_size: 512
    
  # Speaker
  speaker:
    embedding_dim: 256
    num_groups: 8
    codes_per_group: 256
    
  # Entropy Coding
  entropy:
    enabled: true
    lm_layers: 3
    lm_dim: 256
    lm_heads: 8
    context_length: 128
    vocab_size: 512
    
  # Decoder (Fusion)
  decoder:
    fusion_dim: 512
    fusion_heads: 8
    fusion_layers: 4
    dropout: 0.1
        
  # Vocoder
  vocoder:
    type: "vocos_v2"
    dim: 512
    num_convnext_layers: 8
    num_res_blocks: 3

training:
  batch_size: 16  # Reduced from 24 to fix OOM
  learning_rate: 5e-5  # Lower for stability (was 1e-4)
  warmup_steps: 2000
  max_steps: 100000
  num_workers: 2  # Reduced from 8 to save RAM
  persistent_workers: true
  
  use_gan: false
  
  # VQ/FSQ
  commitment_weight: 0.25
  
  # =========================================
  # LOSS WEIGHTS - BALANCED SUITE
  # =========================================
  stft_weight: 5.0              # Core spectral
  bandwise_mel_weight: 3.0      # Band-wise perceptual
  waveform_weight: 1.0          # Time-domain phase
  spectral_flux_weight: 0.5     # Temporal smoothness
  
  # DISABLED (broken/heavy/conflicting)
  speaker_loss_weight: 0.0
  phase_loss_weight: 0.0
  mfcc_weight: 0.0
  multi_mel_weight: 0.0
  feature_loss_weight: 0.0
  mel_weight: 0.0  # Replaced by bandwise
  
  entropy_weight: 0.01
  sharpener_enabled: false
  
  # Logging
  log_every: 100
  eval_every: 3000
  save_every: 500
  
data:
  train_manifest: "/home/sperm/siren/SIREN/data/mixed_train.json"
  val_manifest: "/home/sperm/siren/SIREN/data/mixed_val.json"
  feature_dir: "/home/sperm/siren/SIREN/data/features_mixed"
  sample_rate: 16000
  max_duration: 15.0
  min_duration: 1.0
  
  multi_speaker: true
  num_speakers: -1

audio:
  sample_rate: 16000
  hop_length: 320
